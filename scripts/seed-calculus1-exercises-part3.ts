/**
 * Seed Calculus 1 Exercises - Part 3 (Topics 11-15)
 * Run with: npx tsx scripts/seed-calculus1-exercises-part3.ts
 */

import { Client, Databases, ID } from "node-appwrite";

const client = new Client()
  .setEndpoint("https://fra.cloud.appwrite.io/v1")
  .setProject("6929739f0023a7777f65")
  .setKey(process.env.APPWRITE_API_KEY || "standard_3e263bf7aa3910bdfc73e9c8989d51e3842c46df7401319705c3c043aa6aa1de846eeb6575b9d8b925d8370b4b6c69dee283308a4a0486c17dad29d560746cce8cc36ac221540dbd98b3d133f9118f400a8f9ab8c0cab5b442fe311bbb87e24b7915213d97e826c0a8a2d7b844bef4d28c022b08a4b208682e104c66dc16c9aa");

const databases = new Databases(client);
const DATABASE_ID = "dailymath";
const COURSE_ID = "calculus-1";

interface Exercise {
  id: string;
  topicId: string;
  question: string;
  questionHe: string;
  difficulty: "easy" | "medium" | "hard";
  xpReward: number;
  answer: string;
  answerType: "numeric" | "expression" | "proof" | "open";
  tip: string;
  tipHe: string;
  estimatedMinutes: number;
}

// ============================================
// TOPIC 11: RELATED RATES (rel-rat)
// ============================================
const RELATED_RATES_EXERCISES: Exercise[] = [
  // Easy (5)
  {
    id: "rel-rat-e-001",
    topicId: "related-rates",
    question: "A circle's radius is increasing at 2 cm/s. Find $\\frac{dA}{dt}$ when $r = 5$ cm.",
    questionHe: "רדיוס מעגל גדל ב-2 סמ/שנ. מצא $\\frac{dA}{dt}$ כאשר $r = 5$ ס\"מ.",
    difficulty: "easy",
    xpReward: 10,
    answer: "20π cm²/s",
    answerType: "expression",
    tip: "A = πr², so dA/dt = 2πr(dr/dt)",
    tipHe: "A = πr², אז dA/dt = 2πr(dr/dt)",
    estimatedMinutes: 4,
  },
  {
    id: "rel-rat-e-002",
    topicId: "related-rates",
    question: "If $x^2 + y^2 = 25$ and $\\frac{dx}{dt} = 3$, find $\\frac{dy}{dt}$ when $x = 3, y = 4$.",
    questionHe: "אם $x^2 + y^2 = 25$ ו-$\\frac{dx}{dt} = 3$, מצא $\\frac{dy}{dt}$ כאשר $x = 3, y = 4$.",
    difficulty: "easy",
    xpReward: 10,
    answer: "-9/4",
    answerType: "expression",
    tip: "Differentiate: 2x(dx/dt) + 2y(dy/dt) = 0",
    tipHe: "גזור: 2x(dx/dt) + 2y(dy/dt) = 0",
    estimatedMinutes: 4,
  },
  {
    id: "rel-rat-e-003",
    topicId: "related-rates",
    question: "A square's side is increasing at 1 cm/s. Find $\\frac{dA}{dt}$ when the side is 10 cm.",
    questionHe: "צלע ריבוע גדלה ב-1 סמ/שנ. מצא $\\frac{dA}{dt}$ כאשר הצלע היא 10 ס\"מ.",
    difficulty: "easy",
    xpReward: 10,
    answer: "20 cm²/s",
    answerType: "expression",
    tip: "A = s², so dA/dt = 2s(ds/dt)",
    tipHe: "A = s², אז dA/dt = 2s(ds/dt)",
    estimatedMinutes: 3,
  },
  {
    id: "rel-rat-e-004",
    topicId: "related-rates",
    question: "If $y = x^3$ and $\\frac{dx}{dt} = 2$, find $\\frac{dy}{dt}$ when $x = 2$.",
    questionHe: "אם $y = x^3$ ו-$\\frac{dx}{dt} = 2$, מצא $\\frac{dy}{dt}$ כאשר $x = 2$.",
    difficulty: "easy",
    xpReward: 10,
    answer: "24",
    answerType: "numeric",
    tip: "dy/dt = 3x²(dx/dt)",
    tipHe: "dy/dt = 3x²(dx/dt)",
    estimatedMinutes: 3,
  },
  {
    id: "rel-rat-e-005",
    topicId: "related-rates",
    question: "A cube's edge is growing at 2 cm/s. Find $\\frac{dV}{dt}$ when edge = 5 cm.",
    questionHe: "צלע קוביה גדלה ב-2 סמ/שנ. מצא $\\frac{dV}{dt}$ כאשר הצלע = 5 ס\"מ.",
    difficulty: "easy",
    xpReward: 10,
    answer: "150 cm³/s",
    answerType: "expression",
    tip: "V = s³, so dV/dt = 3s²(ds/dt)",
    tipHe: "V = s³, אז dV/dt = 3s²(ds/dt)",
    estimatedMinutes: 4,
  },
  // Medium (5)
  {
    id: "rel-rat-m-001",
    topicId: "related-rates",
    question: "A ladder 10 ft long rests against a wall. If the bottom slides away at 1 ft/s, how fast is the top sliding down when the bottom is 6 ft from the wall?",
    questionHe: "סולם באורך 10 רגל נשען על קיר. אם התחתית מתרחקת ב-1 רגל/שנ, כמה מהר יורד הראש כאשר התחתית 6 רגל מהקיר?",
    difficulty: "medium",
    xpReward: 15,
    answer: "-3/4 ft/s",
    answerType: "expression",
    tip: "x² + y² = 100. When x = 6, y = 8. Differentiate to find dy/dt.",
    tipHe: "x² + y² = 100. כאשר x = 6, y = 8. גזור למציאת dy/dt.",
    estimatedMinutes: 6,
  },
  {
    id: "rel-rat-m-002",
    topicId: "related-rates",
    question: "A spherical balloon is inflated at 100 cm³/s. How fast is the radius increasing when r = 5 cm?",
    questionHe: "בלון כדורי מתנפח ב-100 סמ³/שנ. כמה מהר הרדיוס גדל כאשר r = 5 ס\"מ?",
    difficulty: "medium",
    xpReward: 15,
    answer: "1/π cm/s",
    answerType: "expression",
    tip: "V = (4/3)πr³, so dV/dt = 4πr²(dr/dt)",
    tipHe: "V = (4/3)πr³, אז dV/dt = 4πr²(dr/dt)",
    estimatedMinutes: 5,
  },
  {
    id: "rel-rat-m-003",
    topicId: "related-rates",
    question: "Water flows into a cone (height 10 m, radius 5 m) at 3 m³/min. How fast is the water level rising when h = 4 m?",
    questionHe: "מים זורמים לחרוט (גובה 10 מ', רדיוס 5 מ') ב-3 מ³/דקה. כמה מהר מפלס המים עולה כאשר h = 4 מ'?",
    difficulty: "medium",
    xpReward: 15,
    answer: "3/(4π) m/min",
    answerType: "expression",
    tip: "By similar triangles r = h/2. V = (1/3)π(h/2)²h = πh³/12",
    tipHe: "לפי משולשים דומים r = h/2. V = (1/3)π(h/2)²h = πh³/12",
    estimatedMinutes: 7,
  },
  {
    id: "rel-rat-m-004",
    topicId: "related-rates",
    question: "Two cars start from the same point, one going north at 60 km/h and one east at 80 km/h. How fast is the distance between them increasing after 1 hour?",
    questionHe: "שתי מכוניות יוצאות מאותה נקודה, אחת צפונה ב-60 קמ/ש ואחת מזרחה ב-80 קמ/ש. כמה מהר המרחק ביניהן גדל אחרי שעה?",
    difficulty: "medium",
    xpReward: 15,
    answer: "100 km/h",
    answerType: "expression",
    tip: "z² = x² + y². After 1 hr: x = 60, y = 80, z = 100",
    tipHe: "z² = x² + y². אחרי שעה: x = 60, y = 80, z = 100",
    estimatedMinutes: 6,
  },
  {
    id: "rel-rat-m-005",
    topicId: "related-rates",
    question: "A spotlight on the ground shines on a wall 20 m away. A person 2 m tall walks toward the wall at 1 m/s. How fast is their shadow on the wall shrinking when they are 8 m from the wall?",
    questionHe: "זרקור על הקרקע מאיר על קיר במרחק 20 מ'. אדם בגובה 2 מ' הולך לכיוון הקיר ב-1 מ/שנ. כמה מהר הצל על הקיר מתכווץ כשהוא 8 מ' מהקיר?",
    difficulty: "medium",
    xpReward: 15,
    answer: "5/18 m/s",
    answerType: "expression",
    tip: "Use similar triangles to relate shadow height to distance",
    tipHe: "השתמש במשולשים דומים לקשר גובה צל למרחק",
    estimatedMinutes: 8,
  },
  // Hard (5)
  {
    id: "rel-rat-h-001",
    topicId: "related-rates",
    question: "A trough is 10 ft long with triangular cross-section (top 3 ft wide, depth 2 ft). Water fills at 12 ft³/min. How fast is the water level rising when h = 1 ft?",
    questionHe: "שוקת באורך 10 רגל עם חתך משולש (רוחב עליון 3 רגל, עומק 2 רגל). מים ממלאים ב-12 רגל³/דקה. כמה מהר מפלס המים עולה כאשר h = 1 רגל?",
    difficulty: "hard",
    xpReward: 20,
    answer: "4/5 ft/min",
    answerType: "expression",
    tip: "By similar triangles, w = (3/2)h. V = (1/2)(w)(h)(10) = (15/2)h²",
    tipHe: "לפי משולשים דומים, w = (3/2)h. V = (1/2)(w)(h)(10) = (15/2)h²",
    estimatedMinutes: 9,
  },
  {
    id: "rel-rat-h-002",
    topicId: "related-rates",
    question: "A plane flies at 500 km/h at altitude 3 km directly toward a radar station. How fast is the distance from the plane to the station decreasing when the plane is 5 km from the station?",
    questionHe: "מטוס טס ב-500 קמ/ש בגובה 3 ק\"מ ישירות לעבר תחנת מכ\"ם. כמה מהר המרחק מהמטוס לתחנה קטן כאשר המטוס במרחק 5 ק\"מ מהתחנה?",
    difficulty: "hard",
    xpReward: 20,
    answer: "-400 km/h",
    answerType: "expression",
    tip: "Let x = horizontal distance. Then s² = x² + 9. When s = 5, x = 4",
    tipHe: "נסמן x = מרחק אופקי. אז s² = x² + 9. כאשר s = 5, x = 4",
    estimatedMinutes: 8,
  },
  {
    id: "rel-rat-h-003",
    topicId: "related-rates",
    question: "A man 6 ft tall walks away from a 15 ft streetlight at 5 ft/s. How fast is the tip of his shadow moving?",
    questionHe: "אדם בגובה 6 רגל הולך מפנס רחוב בגובה 15 רגל ב-5 רגל/שנ. כמה מהר קצה הצל שלו נע?",
    difficulty: "hard",
    xpReward: 20,
    answer: "25/3 ft/s",
    answerType: "expression",
    tip: "Let x = distance from light, s = shadow length. By similar triangles: 15/(x+s) = 6/s",
    tipHe: "נסמן x = מרחק מהפנס, s = אורך הצל. לפי משולשים דומים: 15/(x+s) = 6/s",
    estimatedMinutes: 9,
  },
  {
    id: "rel-rat-h-004",
    topicId: "related-rates",
    question: "A boat is pulled toward a dock by a rope attached to the bow, 1 m above the water. The rope is wound at 1 m/s. How fast is the boat approaching when 5 m of rope is out?",
    questionHe: "סירה נמשכת לרציף בחבל הקשור לחרטום, 1 מ' מעל המים. החבל נגלל ב-1 מ/שנ. כמה מהר הסירה מתקרבת כאשר 5 מ' חבל בחוץ?",
    difficulty: "hard",
    xpReward: 20,
    answer: "-5/(2√6) m/s",
    answerType: "expression",
    tip: "r² = x² + 1 where r = rope length, x = horizontal distance",
    tipHe: "r² = x² + 1 כאשר r = אורך חבל, x = מרחק אופקי",
    estimatedMinutes: 8,
  },
  {
    id: "rel-rat-h-005",
    topicId: "related-rates",
    question: "Two sides of a triangle are 5 and 8 cm. The angle between them increases at 0.1 rad/s. How fast is the area changing when θ = π/6?",
    questionHe: "שתי צלעות משולש הן 5 ו-8 ס\"מ. הזווית ביניהן גדלה ב-0.1 רד/שנ. כמה מהר השטח משתנה כאשר θ = π/6?",
    difficulty: "hard",
    xpReward: 20,
    answer: "√3 cm²/s",
    answerType: "expression",
    tip: "A = (1/2)ab sin θ, so dA/dt = (1/2)ab cos θ (dθ/dt)",
    tipHe: "A = (1/2)ab sin θ, אז dA/dt = (1/2)ab cos θ (dθ/dt)",
    estimatedMinutes: 7,
  },
];

// ============================================
// TOPIC 12: EXTREMA & OPTIMIZATION (ext-opt)
// ============================================
const EXTREMA_OPTIMIZATION_EXERCISES: Exercise[] = [
  // Easy (5)
  {
    id: "ext-opt-e-001",
    topicId: "extrema-optimization",
    question: "Find the critical points of $f(x) = x^3 - 3x$",
    questionHe: "מצא את הנקודות הקריטיות של $f(x) = x^3 - 3x$",
    difficulty: "easy",
    xpReward: 10,
    answer: "x = 1, x = -1",
    answerType: "expression",
    tip: "Set f'(x) = 0: 3x² - 3 = 0",
    tipHe: "הצב f'(x) = 0: 3x² - 3 = 0",
    estimatedMinutes: 3,
  },
  {
    id: "ext-opt-e-002",
    topicId: "extrema-optimization",
    question: "Find the absolute maximum of $f(x) = -x^2 + 4x$ on $[0, 3]$",
    questionHe: "מצא את המקסימום המוחלט של $f(x) = -x^2 + 4x$ על $[0, 3]$",
    difficulty: "easy",
    xpReward: 10,
    answer: "4 at x = 2",
    answerType: "expression",
    tip: "Find critical points, evaluate at endpoints and critical points",
    tipHe: "מצא נקודות קריטיות, חשב בקצוות ובנקודות הקריטיות",
    estimatedMinutes: 4,
  },
  {
    id: "ext-opt-e-003",
    topicId: "extrema-optimization",
    question: "Classify the critical point of $f(x) = x^2 - 4x + 3$ using the second derivative",
    questionHe: "סווג את הנקודה הקריטית של $f(x) = x^2 - 4x + 3$ באמצעות הנגזרת השנייה",
    difficulty: "easy",
    xpReward: 10,
    answer: "minimum at x = 2",
    answerType: "expression",
    tip: "f'(x) = 2x - 4 = 0 → x = 2. f''(x) = 2 > 0 → minimum",
    tipHe: "f'(x) = 2x - 4 = 0 → x = 2. f''(x) = 2 > 0 → מינימום",
    estimatedMinutes: 4,
  },
  {
    id: "ext-opt-e-004",
    topicId: "extrema-optimization",
    question: "Find the minimum value of $f(x) = x^2 + 2x + 5$",
    questionHe: "מצא את הערך המינימלי של $f(x) = x^2 + 2x + 5$",
    difficulty: "easy",
    xpReward: 10,
    answer: "4",
    answerType: "numeric",
    tip: "f'(x) = 0 gives x = -1, then evaluate f(-1)",
    tipHe: "f'(x) = 0 נותן x = -1, ואז חשב f(-1)",
    estimatedMinutes: 4,
  },
  {
    id: "ext-opt-e-005",
    topicId: "extrema-optimization",
    question: "Where is $f(x) = x^3$ increasing?",
    questionHe: "איפה $f(x) = x^3$ עולה?",
    difficulty: "easy",
    xpReward: 10,
    answer: "all x (everywhere)",
    answerType: "open",
    tip: "f'(x) = 3x² ≥ 0 for all x",
    tipHe: "f'(x) = 3x² ≥ 0 לכל x",
    estimatedMinutes: 3,
  },
  // Medium (5)
  {
    id: "ext-opt-m-001",
    topicId: "extrema-optimization",
    question: "Find the dimensions of a rectangle with perimeter 20 that maximizes area",
    questionHe: "מצא את ממדי מלבן עם היקף 20 שממקסם שטח",
    difficulty: "medium",
    xpReward: 15,
    answer: "5 × 5 (square)",
    answerType: "expression",
    tip: "Let l + w = 10. Maximize A = lw = l(10-l)",
    tipHe: "נסמן l + w = 10. מקסם A = lw = l(10-l)",
    estimatedMinutes: 6,
  },
  {
    id: "ext-opt-m-002",
    topicId: "extrema-optimization",
    question: "Find intervals where $f(x) = x^3 - 6x^2 + 9x + 1$ is increasing",
    questionHe: "מצא קטעים שבהם $f(x) = x^3 - 6x^2 + 9x + 1$ עולה",
    difficulty: "medium",
    xpReward: 15,
    answer: "(-∞, 1) ∪ (3, ∞)",
    answerType: "expression",
    tip: "f'(x) = 3x² - 12x + 9 = 3(x-1)(x-3). Find where f' > 0",
    tipHe: "f'(x) = 3x² - 12x + 9 = 3(x-1)(x-3). מצא איפה f' > 0",
    estimatedMinutes: 5,
  },
  {
    id: "ext-opt-m-003",
    topicId: "extrema-optimization",
    question: "Find local extrema of $f(x) = x^4 - 4x^3$",
    questionHe: "מצא קיצונים מקומיים של $f(x) = x^4 - 4x^3$",
    difficulty: "medium",
    xpReward: 15,
    answer: "local min at x = 3, value = -27",
    answerType: "expression",
    tip: "f'(x) = 4x³ - 12x² = 4x²(x-3). Critical points: x = 0, 3",
    tipHe: "f'(x) = 4x³ - 12x² = 4x²(x-3). נקודות קריטיות: x = 0, 3",
    estimatedMinutes: 6,
  },
  {
    id: "ext-opt-m-004",
    topicId: "extrema-optimization",
    question: "A farmer has 200 m of fence to enclose a rectangular area against a barn (no fence needed on barn side). What dimensions maximize area?",
    questionHe: "לחקלאי יש 200 מ' גדר לגידור שטח מלבני ליד אסם (אין צורך בגדר בצד האסם). אילו ממדים ממקסמים שטח?",
    difficulty: "medium",
    xpReward: 15,
    answer: "50 m × 100 m",
    answerType: "expression",
    tip: "If x is perpendicular to barn, y parallel: 2x + y = 200. Maximize A = xy",
    tipHe: "אם x מאונך לאסם, y מקביל: 2x + y = 200. מקסם A = xy",
    estimatedMinutes: 6,
  },
  {
    id: "ext-opt-m-005",
    topicId: "extrema-optimization",
    question: "Find the point on $y = x^2$ closest to $(0, 1)$",
    questionHe: "מצא את הנקודה על $y = x^2$ הקרובה ביותר ל-$(0, 1)$",
    difficulty: "medium",
    xpReward: 15,
    answer: "(0, 0)",
    answerType: "expression",
    tip: "Minimize D² = x² + (x² - 1)². Let u = x²",
    tipHe: "מזער D² = x² + (x² - 1)². נסמן u = x²",
    estimatedMinutes: 7,
  },
  // Hard (5)
  {
    id: "ext-opt-h-001",
    topicId: "extrema-optimization",
    question: "A box with square base and open top must have volume 32000 cm³. Find dimensions that minimize surface area.",
    questionHe: "קופסה עם בסיס מרובע ופתוחה מלמעלה חייבת להיות בנפח 32000 סמ³. מצא ממדים שממזערים שטח פנים.",
    difficulty: "hard",
    xpReward: 20,
    answer: "40 cm × 40 cm × 20 cm",
    answerType: "expression",
    tip: "V = x²h = 32000, S = x² + 4xh. Substitute h = 32000/x²",
    tipHe: "V = x²h = 32000, S = x² + 4xh. הצב h = 32000/x²",
    estimatedMinutes: 9,
  },
  {
    id: "ext-opt-h-002",
    topicId: "extrema-optimization",
    question: "Find the dimensions of the largest rectangle inscribed in a semicircle of radius 2.",
    questionHe: "מצא את ממדי המלבן הגדול ביותר החסום בחצי עיגול ברדיוס 2.",
    difficulty: "hard",
    xpReward: 20,
    answer: "2√2 × √2",
    answerType: "expression",
    tip: "If corner at (x, y), then x² + y² = 4, y > 0. Area = 2xy",
    tipHe: "אם פינה ב-(x, y), אז x² + y² = 4, y > 0. שטח = 2xy",
    estimatedMinutes: 9,
  },
  {
    id: "ext-opt-h-003",
    topicId: "extrema-optimization",
    question: "A can is to hold 1000 ml. Find the dimensions that minimize material (including top and bottom).",
    questionHe: "פחית צריכה להכיל 1000 מ\"ל. מצא את הממדים שממזערים חומר (כולל תחתית ומכסה).",
    difficulty: "hard",
    xpReward: 20,
    answer: "r = (500/π)^(1/3), h = 2r",
    answerType: "expression",
    tip: "V = πr²h = 1000, S = 2πr² + 2πrh. Substitute h = 1000/(πr²)",
    tipHe: "V = πr²h = 1000, S = 2πr² + 2πrh. הצב h = 1000/(πr²)",
    estimatedMinutes: 10,
  },
  {
    id: "ext-opt-h-004",
    topicId: "extrema-optimization",
    question: "Find two positive numbers whose sum is 100 and whose product is maximum.",
    questionHe: "מצא שני מספרים חיוביים שסכומם 100 ומכפלתם מקסימלית.",
    difficulty: "hard",
    xpReward: 20,
    answer: "50 and 50",
    answerType: "expression",
    tip: "Let x + y = 100. Maximize P = xy = x(100-x)",
    tipHe: "נסמן x + y = 100. מקסם P = xy = x(100-x)",
    estimatedMinutes: 5,
  },
  {
    id: "ext-opt-h-005",
    topicId: "extrema-optimization",
    question: "A window has the shape of a rectangle topped by a semicircle. If the perimeter is 10 m, find dimensions that maximize light (area).",
    questionHe: "לחלון יש צורת מלבן עם חצי עיגול למעלה. אם ההיקף 10 מ', מצא ממדים שממקסמים אור (שטח).",
    difficulty: "hard",
    xpReward: 20,
    answer: "width = 20/(4+π), height = 10/(4+π)",
    answerType: "expression",
    tip: "Let width = 2r. Perimeter = 2h + 2r + πr = 10. Area = 2rh + (1/2)πr²",
    tipHe: "נסמן רוחב = 2r. היקף = 2h + 2r + πr = 10. שטח = 2rh + (1/2)πr²",
    estimatedMinutes: 10,
  },
];

// ============================================
// TOPIC 13: CURVE SKETCHING & L'HOPITAL (curv)
// ============================================
const CURVE_SKETCHING_EXERCISES: Exercise[] = [
  // Easy (5)
  {
    id: "curv-e-001",
    topicId: "curve-sketching",
    question: "Evaluate using L'Hôpital: $\\lim_{x \\to 0} \\frac{\\sin x}{x}$",
    questionHe: "חשב באמצעות לופיטל: $\\lim_{x \\to 0} \\frac{\\sin x}{x}$",
    difficulty: "easy",
    xpReward: 10,
    answer: "1",
    answerType: "numeric",
    tip: "0/0 form. Apply L'Hôpital: lim (cos x)/1 = 1",
    tipHe: "צורת 0/0. הפעל לופיטל: lim (cos x)/1 = 1",
    estimatedMinutes: 3,
  },
  {
    id: "curv-e-002",
    topicId: "curve-sketching",
    question: "Find the inflection points of $f(x) = x^3$",
    questionHe: "מצא את נקודות הפיתול של $f(x) = x^3$",
    difficulty: "easy",
    xpReward: 10,
    answer: "x = 0",
    answerType: "expression",
    tip: "f''(x) = 6x = 0 at x = 0, and f'' changes sign there",
    tipHe: "f''(x) = 6x = 0 ב-x = 0, ו-f'' משנה סימן שם",
    estimatedMinutes: 3,
  },
  {
    id: "curv-e-003",
    topicId: "curve-sketching",
    question: "Where is $f(x) = x^2$ concave up?",
    questionHe: "איפה $f(x) = x^2$ קעורה כלפי מעלה?",
    difficulty: "easy",
    xpReward: 10,
    answer: "all x (everywhere)",
    answerType: "open",
    tip: "f''(x) = 2 > 0 for all x",
    tipHe: "f''(x) = 2 > 0 לכל x",
    estimatedMinutes: 2,
  },
  {
    id: "curv-e-004",
    topicId: "curve-sketching",
    question: "Find the horizontal asymptote of $f(x) = \\frac{2x}{x+1}$",
    questionHe: "מצא את האסימפטוטה האופקית של $f(x) = \\frac{2x}{x+1}$",
    difficulty: "easy",
    xpReward: 10,
    answer: "y = 2",
    answerType: "expression",
    tip: "lim as x → ∞ of 2x/(x+1) = 2",
    tipHe: "lim כאשר x → ∞ של 2x/(x+1) = 2",
    estimatedMinutes: 3,
  },
  {
    id: "curv-e-005",
    topicId: "curve-sketching",
    question: "Find the vertical asymptote of $f(x) = \\frac{1}{x-2}$",
    questionHe: "מצא את האסימפטוטה האנכית של $f(x) = \\frac{1}{x-2}$",
    difficulty: "easy",
    xpReward: 10,
    answer: "x = 2",
    answerType: "expression",
    tip: "Vertical asymptote where denominator = 0",
    tipHe: "אסימפטוטה אנכית כאשר מכנה = 0",
    estimatedMinutes: 2,
  },
  // Medium (5)
  {
    id: "curv-m-001",
    topicId: "curve-sketching",
    question: "Evaluate: $\\lim_{x \\to 0} \\frac{e^x - 1}{x}$ using L'Hôpital",
    questionHe: "חשב: $\\lim_{x \\to 0} \\frac{e^x - 1}{x}$ באמצעות לופיטל",
    difficulty: "medium",
    xpReward: 15,
    answer: "1",
    answerType: "numeric",
    tip: "0/0 form. L'Hôpital: lim eˣ/1 = 1",
    tipHe: "צורת 0/0. לופיטל: lim eˣ/1 = 1",
    estimatedMinutes: 4,
  },
  {
    id: "curv-m-002",
    topicId: "curve-sketching",
    question: "Find intervals of concavity for $f(x) = x^3 - 3x^2 + 2$",
    questionHe: "מצא קטעי קעירות עבור $f(x) = x^3 - 3x^2 + 2$",
    difficulty: "medium",
    xpReward: 15,
    answer: "concave down on (-∞, 1), concave up on (1, ∞)",
    answerType: "expression",
    tip: "f''(x) = 6x - 6 = 6(x-1). Sign changes at x = 1",
    tipHe: "f''(x) = 6x - 6 = 6(x-1). סימן משתנה ב-x = 1",
    estimatedMinutes: 5,
  },
  {
    id: "curv-m-003",
    topicId: "curve-sketching",
    question: "Evaluate: $\\lim_{x \\to \\infty} \\frac{x^2}{e^x}$",
    questionHe: "חשב: $\\lim_{x \\to \\infty} \\frac{x^2}{e^x}$",
    difficulty: "medium",
    xpReward: 15,
    answer: "0",
    answerType: "numeric",
    tip: "∞/∞ form. Apply L'Hôpital twice",
    tipHe: "צורת ∞/∞. הפעל לופיטל פעמיים",
    estimatedMinutes: 5,
  },
  {
    id: "curv-m-004",
    topicId: "curve-sketching",
    question: "Find all asymptotes of $f(x) = \\frac{x^2 - 1}{x^2 - 4}$",
    questionHe: "מצא את כל האסימפטוטות של $f(x) = \\frac{x^2 - 1}{x^2 - 4}$",
    difficulty: "medium",
    xpReward: 15,
    answer: "vertical: x = 2, x = -2; horizontal: y = 1",
    answerType: "expression",
    tip: "VA where denom = 0, HA from limit at infinity",
    tipHe: "אנכית כאשר מכנה = 0, אופקית מגבול באינסוף",
    estimatedMinutes: 5,
  },
  {
    id: "curv-m-005",
    topicId: "curve-sketching",
    question: "Evaluate: $\\lim_{x \\to 0^+} x \\ln x$",
    questionHe: "חשב: $\\lim_{x \\to 0^+} x \\ln x$",
    difficulty: "medium",
    xpReward: 15,
    answer: "0",
    answerType: "numeric",
    tip: "0·(-∞) form. Rewrite as (ln x)/(1/x), then L'Hôpital",
    tipHe: "צורת 0·(-∞). רשום מחדש כ-(ln x)/(1/x), ואז לופיטל",
    estimatedMinutes: 6,
  },
  // Hard (5)
  {
    id: "curv-h-001",
    topicId: "curve-sketching",
    question: "Evaluate: $\\lim_{x \\to 0} \\left(\\frac{1}{x} - \\frac{1}{\\sin x}\\right)$",
    questionHe: "חשב: $\\lim_{x \\to 0} \\left(\\frac{1}{x} - \\frac{1}{\\sin x}\\right)$",
    difficulty: "hard",
    xpReward: 20,
    answer: "0",
    answerType: "numeric",
    tip: "∞ - ∞ form. Combine fractions: (sin x - x)/(x sin x), then L'Hôpital",
    tipHe: "צורת ∞ - ∞. אחד שברים: (sin x - x)/(x sin x), ואז לופיטל",
    estimatedMinutes: 8,
  },
  {
    id: "curv-h-002",
    topicId: "curve-sketching",
    question: "Evaluate: $\\lim_{x \\to 0^+} x^x$",
    questionHe: "חשב: $\\lim_{x \\to 0^+} x^x$",
    difficulty: "hard",
    xpReward: 20,
    answer: "1",
    answerType: "numeric",
    tip: "0⁰ form. Let y = xˣ, take ln: ln y = x ln x → 0. So y → e⁰ = 1",
    tipHe: "צורת 0⁰. נסמן y = xˣ, קח ln: ln y = x ln x → 0. אז y → e⁰ = 1",
    estimatedMinutes: 7,
  },
  {
    id: "curv-h-003",
    topicId: "curve-sketching",
    question: "Sketch the curve $y = \\frac{x^2}{x^2-1}$ including all key features",
    questionHe: "שרטט את העקומה $y = \\frac{x^2}{x^2-1}$ כולל כל המאפיינים העיקריים",
    difficulty: "hard",
    xpReward: 20,
    answer: "VA: x=±1, HA: y=1, local max at (0,0)",
    answerType: "expression",
    tip: "Check domain, asymptotes, symmetry, critical points, concavity",
    tipHe: "בדוק תחום, אסימפטוטות, סימטריה, נקודות קריטיות, קעירות",
    estimatedMinutes: 10,
  },
  {
    id: "curv-h-004",
    topicId: "curve-sketching",
    question: "Evaluate: $\\lim_{x \\to 0} \\frac{e^x - 1 - x}{x^2}$",
    questionHe: "חשב: $\\lim_{x \\to 0} \\frac{e^x - 1 - x}{x^2}$",
    difficulty: "hard",
    xpReward: 20,
    answer: "1/2",
    answerType: "expression",
    tip: "0/0 form. Apply L'Hôpital twice",
    tipHe: "צורת 0/0. הפעל לופיטל פעמיים",
    estimatedMinutes: 6,
  },
  {
    id: "curv-h-005",
    topicId: "curve-sketching",
    question: "Evaluate: $\\lim_{x \\to \\infty} \\left(1 + \\frac{1}{x}\\right)^x$",
    questionHe: "חשב: $\\lim_{x \\to \\infty} \\left(1 + \\frac{1}{x}\\right)^x$",
    difficulty: "hard",
    xpReward: 20,
    answer: "e",
    answerType: "expression",
    tip: "1^∞ form. Take ln: x ln(1+1/x). Rewrite as ln(1+1/x)/(1/x), apply L'Hôpital",
    tipHe: "צורת 1^∞. קח ln: x ln(1+1/x). רשום מחדש והפעל לופיטל",
    estimatedMinutes: 8,
  },
];

// ============================================
// TOPIC 14: ANTIDERIVATIVES (anti)
// ============================================
const ANTIDERIVATIVES_EXERCISES: Exercise[] = [
  // Easy (5)
  {
    id: "anti-e-001",
    topicId: "antiderivatives",
    question: "Find $\\int x^3 \\, dx$",
    questionHe: "מצא $\\int x^3 \\, dx$",
    difficulty: "easy",
    xpReward: 10,
    answer: "x⁴/4 + C",
    answerType: "expression",
    tip: "Power rule: ∫xⁿ dx = xⁿ⁺¹/(n+1) + C",
    tipHe: "כלל החזקה: ∫xⁿ dx = xⁿ⁺¹/(n+1) + C",
    estimatedMinutes: 2,
  },
  {
    id: "anti-e-002",
    topicId: "antiderivatives",
    question: "Find $\\int \\cos x \\, dx$",
    questionHe: "מצא $\\int \\cos x \\, dx$",
    difficulty: "easy",
    xpReward: 10,
    answer: "sin x + C",
    answerType: "expression",
    tip: "Since d/dx[sin x] = cos x",
    tipHe: "מכיוון ש-d/dx[sin x] = cos x",
    estimatedMinutes: 2,
  },
  {
    id: "anti-e-003",
    topicId: "antiderivatives",
    question: "Find $\\int e^x \\, dx$",
    questionHe: "מצא $\\int e^x \\, dx$",
    difficulty: "easy",
    xpReward: 10,
    answer: "eˣ + C",
    answerType: "expression",
    tip: "The exponential is its own antiderivative",
    tipHe: "האקספוננציאל הוא האנטי-נגזרת של עצמו",
    estimatedMinutes: 2,
  },
  {
    id: "anti-e-004",
    topicId: "antiderivatives",
    question: "Find $\\int \\frac{1}{x} \\, dx$",
    questionHe: "מצא $\\int \\frac{1}{x} \\, dx$",
    difficulty: "easy",
    xpReward: 10,
    answer: "ln|x| + C",
    answerType: "expression",
    tip: "The antiderivative of 1/x is ln|x|",
    tipHe: "האנטי-נגזרת של 1/x היא ln|x|",
    estimatedMinutes: 2,
  },
  {
    id: "anti-e-005",
    topicId: "antiderivatives",
    question: "Find $\\int 5 \\, dx$",
    questionHe: "מצא $\\int 5 \\, dx$",
    difficulty: "easy",
    xpReward: 10,
    answer: "5x + C",
    answerType: "expression",
    tip: "The antiderivative of a constant k is kx",
    tipHe: "האנטי-נגזרת של קבוע k היא kx",
    estimatedMinutes: 2,
  },
  // Medium (5)
  {
    id: "anti-m-001",
    topicId: "antiderivatives",
    question: "Find $\\int (3x^2 - 2x + 5) \\, dx$",
    questionHe: "מצא $\\int (3x^2 - 2x + 5) \\, dx$",
    difficulty: "medium",
    xpReward: 15,
    answer: "x³ - x² + 5x + C",
    answerType: "expression",
    tip: "Integrate term by term",
    tipHe: "בצע אינטגרציה איבר איבר",
    estimatedMinutes: 4,
  },
  {
    id: "anti-m-002",
    topicId: "antiderivatives",
    question: "Evaluate: $\\int_0^2 x^2 \\, dx$",
    questionHe: "חשב: $\\int_0^2 x^2 \\, dx$",
    difficulty: "medium",
    xpReward: 15,
    answer: "8/3",
    answerType: "expression",
    tip: "[x³/3]₀² = 8/3 - 0 = 8/3",
    tipHe: "[x³/3]₀² = 8/3 - 0 = 8/3",
    estimatedMinutes: 4,
  },
  {
    id: "anti-m-003",
    topicId: "antiderivatives",
    question: "Find $\\int \\sec^2 x \\, dx$",
    questionHe: "מצא $\\int \\sec^2 x \\, dx$",
    difficulty: "medium",
    xpReward: 15,
    answer: "tan x + C",
    answerType: "expression",
    tip: "Since d/dx[tan x] = sec²x",
    tipHe: "מכיוון ש-d/dx[tan x] = sec²x",
    estimatedMinutes: 3,
  },
  {
    id: "anti-m-004",
    topicId: "antiderivatives",
    question: "Evaluate: $\\int_0^{\\pi} \\sin x \\, dx$",
    questionHe: "חשב: $\\int_0^{\\pi} \\sin x \\, dx$",
    difficulty: "medium",
    xpReward: 15,
    answer: "2",
    answerType: "numeric",
    tip: "[-cos x]₀^π = -cos π - (-cos 0) = 1 + 1 = 2",
    tipHe: "[-cos x]₀^π = -cos π - (-cos 0) = 1 + 1 = 2",
    estimatedMinutes: 4,
  },
  {
    id: "anti-m-005",
    topicId: "antiderivatives",
    question: "Find $\\int \\frac{2}{x^3} \\, dx$",
    questionHe: "מצא $\\int \\frac{2}{x^3} \\, dx$",
    difficulty: "medium",
    xpReward: 15,
    answer: "-1/x² + C",
    answerType: "expression",
    tip: "Rewrite as 2x⁻³, then integrate",
    tipHe: "רשום מחדש כ-2x⁻³, ואז בצע אינטגרציה",
    estimatedMinutes: 4,
  },
  // Hard (5)
  {
    id: "anti-h-001",
    topicId: "antiderivatives",
    question: "Find $\\int \\sqrt{x} \\, dx$",
    questionHe: "מצא $\\int \\sqrt{x} \\, dx$",
    difficulty: "hard",
    xpReward: 20,
    answer: "(2/3)x^(3/2) + C",
    answerType: "expression",
    tip: "√x = x^(1/2). Apply power rule",
    tipHe: "√x = x^(1/2). הפעל כלל החזקה",
    estimatedMinutes: 4,
  },
  {
    id: "anti-h-002",
    topicId: "antiderivatives",
    question: "Evaluate: $\\int_1^e \\frac{1}{x} \\, dx$",
    questionHe: "חשב: $\\int_1^e \\frac{1}{x} \\, dx$",
    difficulty: "hard",
    xpReward: 20,
    answer: "1",
    answerType: "numeric",
    tip: "[ln x]₁ᵉ = ln e - ln 1 = 1 - 0 = 1",
    tipHe: "[ln x]₁ᵉ = ln e - ln 1 = 1 - 0 = 1",
    estimatedMinutes: 4,
  },
  {
    id: "anti-h-003",
    topicId: "antiderivatives",
    question: "Find the area under $y = x^2$ from $x = 0$ to $x = 3$",
    questionHe: "מצא את השטח מתחת ל-$y = x^2$ מ-$x = 0$ עד $x = 3$",
    difficulty: "hard",
    xpReward: 20,
    answer: "9",
    answerType: "numeric",
    tip: "∫₀³ x² dx = [x³/3]₀³ = 27/3 = 9",
    tipHe: "∫₀³ x² dx = [x³/3]₀³ = 27/3 = 9",
    estimatedMinutes: 5,
  },
  {
    id: "anti-h-004",
    topicId: "antiderivatives",
    question: "Find $\\int (e^x + \\frac{1}{x} - \\sin x) \\, dx$",
    questionHe: "מצא $\\int (e^x + \\frac{1}{x} - \\sin x) \\, dx$",
    difficulty: "hard",
    xpReward: 20,
    answer: "eˣ + ln|x| + cos x + C",
    answerType: "expression",
    tip: "Integrate each term separately",
    tipHe: "בצע אינטגרציה לכל איבר בנפרד",
    estimatedMinutes: 5,
  },
  {
    id: "anti-h-005",
    topicId: "antiderivatives",
    question: "If $F'(x) = x^2 - 3$ and $F(0) = 2$, find $F(x)$",
    questionHe: "אם $F'(x) = x^2 - 3$ ו-$F(0) = 2$, מצא $F(x)$",
    difficulty: "hard",
    xpReward: 20,
    answer: "x³/3 - 3x + 2",
    answerType: "expression",
    tip: "F(x) = x³/3 - 3x + C. Use F(0) = 2 to find C",
    tipHe: "F(x) = x³/3 - 3x + C. השתמש ב-F(0) = 2 למציאת C",
    estimatedMinutes: 5,
  },
];

// ============================================
// TOPIC 15: FTC & SUBSTITUTION (ftc)
// ============================================
const FTC_SUBSTITUTION_EXERCISES: Exercise[] = [
  // Easy (5)
  {
    id: "ftc-e-001",
    topicId: "ftc-substitution",
    question: "Find $\\frac{d}{dx} \\int_0^x t^2 \\, dt$",
    questionHe: "מצא $\\frac{d}{dx} \\int_0^x t^2 \\, dt$",
    difficulty: "easy",
    xpReward: 10,
    answer: "x²",
    answerType: "expression",
    tip: "FTC Part 1: d/dx ∫ₐˣ f(t)dt = f(x)",
    tipHe: "חלק 1 של המשפט היסודי: d/dx ∫ₐˣ f(t)dt = f(x)",
    estimatedMinutes: 2,
  },
  {
    id: "ftc-e-002",
    topicId: "ftc-substitution",
    question: "Evaluate: $\\int_1^4 \\sqrt{x} \\, dx$",
    questionHe: "חשב: $\\int_1^4 \\sqrt{x} \\, dx$",
    difficulty: "easy",
    xpReward: 10,
    answer: "14/3",
    answerType: "expression",
    tip: "Antiderivative is (2/3)x^(3/2). Evaluate at bounds",
    tipHe: "האנטי-נגזרת היא (2/3)x^(3/2). הצב בגבולות",
    estimatedMinutes: 4,
  },
  {
    id: "ftc-e-003",
    topicId: "ftc-substitution",
    question: "Find $\\int 2x(x^2+1)^3 \\, dx$ using substitution",
    questionHe: "מצא $\\int 2x(x^2+1)^3 \\, dx$ באמצעות הצבה",
    difficulty: "easy",
    xpReward: 10,
    answer: "(x²+1)⁴/4 + C",
    answerType: "expression",
    tip: "Let u = x²+1, du = 2x dx",
    tipHe: "נסמן u = x²+1, du = 2x dx",
    estimatedMinutes: 4,
  },
  {
    id: "ftc-e-004",
    topicId: "ftc-substitution",
    question: "Find $\\int \\cos(3x) \\, dx$",
    questionHe: "מצא $\\int \\cos(3x) \\, dx$",
    difficulty: "easy",
    xpReward: 10,
    answer: "(1/3)sin(3x) + C",
    answerType: "expression",
    tip: "Let u = 3x, du = 3dx, so dx = du/3",
    tipHe: "נסמן u = 3x, du = 3dx, אז dx = du/3",
    estimatedMinutes: 3,
  },
  {
    id: "ftc-e-005",
    topicId: "ftc-substitution",
    question: "Find $\\int e^{2x} \\, dx$",
    questionHe: "מצא $\\int e^{2x} \\, dx$",
    difficulty: "easy",
    xpReward: 10,
    answer: "(1/2)e^(2x) + C",
    answerType: "expression",
    tip: "Let u = 2x, du = 2dx",
    tipHe: "נסמן u = 2x, du = 2dx",
    estimatedMinutes: 3,
  },
  // Medium (5)
  {
    id: "ftc-m-001",
    topicId: "ftc-substitution",
    question: "Find $\\int x\\sqrt{x^2+1} \\, dx$",
    questionHe: "מצא $\\int x\\sqrt{x^2+1} \\, dx$",
    difficulty: "medium",
    xpReward: 15,
    answer: "(1/3)(x²+1)^(3/2) + C",
    answerType: "expression",
    tip: "Let u = x²+1, du = 2x dx → x dx = du/2",
    tipHe: "נסמן u = x²+1, du = 2x dx → x dx = du/2",
    estimatedMinutes: 5,
  },
  {
    id: "ftc-m-002",
    topicId: "ftc-substitution",
    question: "Evaluate: $\\int_0^1 2x(x^2+1)^4 \\, dx$",
    questionHe: "חשב: $\\int_0^1 2x(x^2+1)^4 \\, dx$",
    difficulty: "medium",
    xpReward: 15,
    answer: "31/5",
    answerType: "expression",
    tip: "u = x²+1. When x=0, u=1. When x=1, u=2",
    tipHe: "u = x²+1. כאשר x=0, u=1. כאשר x=1, u=2",
    estimatedMinutes: 6,
  },
  {
    id: "ftc-m-003",
    topicId: "ftc-substitution",
    question: "Find $\\int \\frac{\\cos x}{\\sin x} \\, dx$",
    questionHe: "מצא $\\int \\frac{\\cos x}{\\sin x} \\, dx$",
    difficulty: "medium",
    xpReward: 15,
    answer: "ln|sin x| + C",
    answerType: "expression",
    tip: "Let u = sin x, du = cos x dx",
    tipHe: "נסמן u = sin x, du = cos x dx",
    estimatedMinutes: 4,
  },
  {
    id: "ftc-m-004",
    topicId: "ftc-substitution",
    question: "Find $\\int \\frac{e^x}{1+e^x} \\, dx$",
    questionHe: "מצא $\\int \\frac{e^x}{1+e^x} \\, dx$",
    difficulty: "medium",
    xpReward: 15,
    answer: "ln(1+eˣ) + C",
    answerType: "expression",
    tip: "Let u = 1+eˣ, du = eˣ dx",
    tipHe: "נסמן u = 1+eˣ, du = eˣ dx",
    estimatedMinutes: 5,
  },
  {
    id: "ftc-m-005",
    topicId: "ftc-substitution",
    question: "Find $\\frac{d}{dx} \\int_0^{x^2} \\sin t \\, dt$",
    questionHe: "מצא $\\frac{d}{dx} \\int_0^{x^2} \\sin t \\, dt$",
    difficulty: "medium",
    xpReward: 15,
    answer: "2x sin(x²)",
    answerType: "expression",
    tip: "FTC with chain rule: f(g(x)) · g'(x) = sin(x²) · 2x",
    tipHe: "משפט יסודי עם כלל השרשרת: f(g(x)) · g'(x) = sin(x²) · 2x",
    estimatedMinutes: 5,
  },
  // Hard (5)
  {
    id: "ftc-h-001",
    topicId: "ftc-substitution",
    question: "Find $\\int \\sin^3 x \\cos x \\, dx$",
    questionHe: "מצא $\\int \\sin^3 x \\cos x \\, dx$",
    difficulty: "hard",
    xpReward: 20,
    answer: "sin⁴x/4 + C",
    answerType: "expression",
    tip: "Let u = sin x, du = cos x dx",
    tipHe: "נסמן u = sin x, du = cos x dx",
    estimatedMinutes: 5,
  },
  {
    id: "ftc-h-002",
    topicId: "ftc-substitution",
    question: "Evaluate: $\\int_0^{\\pi/2} \\sin^2 x \\cos x \\, dx$",
    questionHe: "חשב: $\\int_0^{\\pi/2} \\sin^2 x \\cos x \\, dx$",
    difficulty: "hard",
    xpReward: 20,
    answer: "1/3",
    answerType: "expression",
    tip: "u = sin x. When x=0, u=0. When x=π/2, u=1",
    tipHe: "u = sin x. כאשר x=0, u=0. כאשר x=π/2, u=1",
    estimatedMinutes: 6,
  },
  {
    id: "ftc-h-003",
    topicId: "ftc-substitution",
    question: "Find $\\int \\frac{x}{\\sqrt{1-x^2}} \\, dx$",
    questionHe: "מצא $\\int \\frac{x}{\\sqrt{1-x^2}} \\, dx$",
    difficulty: "hard",
    xpReward: 20,
    answer: "-√(1-x²) + C",
    answerType: "expression",
    tip: "Let u = 1-x², du = -2x dx",
    tipHe: "נסמן u = 1-x², du = -2x dx",
    estimatedMinutes: 6,
  },
  {
    id: "ftc-h-004",
    topicId: "ftc-substitution",
    question: "Find $\\int x e^{x^2} \\, dx$",
    questionHe: "מצא $\\int x e^{x^2} \\, dx$",
    difficulty: "hard",
    xpReward: 20,
    answer: "(1/2)e^(x²) + C",
    answerType: "expression",
    tip: "Let u = x², du = 2x dx",
    tipHe: "נסמן u = x², du = 2x dx",
    estimatedMinutes: 5,
  },
  {
    id: "ftc-h-005",
    topicId: "ftc-substitution",
    question: "Evaluate: $\\int_0^1 \\frac{2x}{(1+x^2)^2} \\, dx$",
    questionHe: "חשב: $\\int_0^1 \\frac{2x}{(1+x^2)^2} \\, dx$",
    difficulty: "hard",
    xpReward: 20,
    answer: "1/2",
    answerType: "expression",
    tip: "u = 1+x². Limits become u=1 to u=2",
    tipHe: "u = 1+x². הגבולות הופכים ל-u=1 עד u=2",
    estimatedMinutes: 7,
  },
];

// Combine all exercises
const ALL_EXERCISES: Exercise[] = [
  ...RELATED_RATES_EXERCISES,
  ...EXTREMA_OPTIMIZATION_EXERCISES,
  ...CURVE_SKETCHING_EXERCISES,
  ...ANTIDERIVATIVES_EXERCISES,
  ...FTC_SUBSTITUTION_EXERCISES,
];

// Generate solutions
function generateSolution(exercise: Exercise) {
  const steps: string[] = [];
  const stepsHe: string[] = [];

  steps.push(`Given: ${exercise.question.replace(/\$/g, '')}`);
  steps.push(`Hint: ${exercise.tip}`);
  steps.push(`Work through the problem step by step.`);
  steps.push(`Answer: $\\boxed{${exercise.answer}}$`);

  stepsHe.push(`נתון: ${exercise.questionHe.replace(/\$/g, '')}`);
  stepsHe.push(`רמז: ${exercise.tipHe}`);
  stepsHe.push(`עבור על הבעיה צעד אחר צעד.`);
  stepsHe.push(`תשובה: $\\boxed{${exercise.answer}}$`);

  return {
    exerciseId: exercise.id,
    solution: `The answer is ${exercise.answer}`,
    steps,
    stepsHe,
  };
}

async function seedExercises() {
  console.log("=== Seeding Calculus 1 Exercises (Topics 11-15) ===\n");

  let created = 0;
  let skipped = 0;

  for (const exercise of ALL_EXERCISES) {
    try {
      await databases.createDocument(DATABASE_ID, "exercises", exercise.id, {
        courseId: COURSE_ID,
        topicId: exercise.topicId,
        question: exercise.question,
        questionHe: exercise.questionHe,
        difficulty: exercise.difficulty,
        xpReward: exercise.xpReward,
        answer: exercise.answer,
        answerType: exercise.answerType,
        tip: exercise.tip,
        tipHe: exercise.tipHe,
        estimatedMinutes: exercise.estimatedMinutes,
        isActive: true,
      });
      console.log(`✓ Created: ${exercise.id}`);
      created++;
    } catch (error: unknown) {
      const err = error as { code?: number; message?: string };
      if (err.code === 409) {
        console.log(`○ Skipped: ${exercise.id} (already exists)`);
        skipped++;
      } else {
        console.error(`✗ Error: ${exercise.id}`, err.message);
      }
    }
  }

  console.log("\n=== Creating Solutions ===\n");

  for (const exercise of ALL_EXERCISES) {
    const solution = generateSolution(exercise);
    try {
      await databases.createDocument(DATABASE_ID, "exercise_solutions", ID.unique(), {
        exerciseId: solution.exerciseId,
        solution: solution.solution,
        steps: JSON.stringify(solution.steps),
        stepsHe: JSON.stringify(solution.stepsHe),
      });
      console.log(`✓ Solution: ${exercise.id}`);
    } catch (error: unknown) {
      const err = error as { code?: number; message?: string };
      if (err.code === 409) {
        console.log(`○ Skipped solution: ${exercise.id}`);
      } else {
        console.error(`✗ Solution error: ${exercise.id}`, err.message);
      }
    }
  }

  console.log("\n=== Summary ===");
  console.log(`Exercises created: ${created}`);
  console.log(`Exercises skipped: ${skipped}`);
  console.log(`Total: ${ALL_EXERCISES.length}`);
}

seedExercises().catch(console.error);
